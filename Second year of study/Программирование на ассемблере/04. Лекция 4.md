## Команды пересылки и арифметические команды

При описании команд, необходимо указывать какие операнды в ней допустимы, а какие нет.

| Местонахождение операнда      | Обозначение | Запись на ассемблере  |
| ---------------------------- | ----------- | --------------------- |
| в команде                    | i8,i16,i32  | константное выражение |
| в регистре общего назначения | r8,r16      | имя регистра          |
| в сегментном регистре        | sr          | CS,DS,SS,ES           |
| в памяти                     | m8,m16,m32  | адресное выражение    | 

Команды пересылки:
1. `mov op1,op2` 
   По этой команде на место первого операнда пересылается значение второго. Флаги команда не меняет.
   
```nasm
MOV AX, 500
MOV BL,DH
```

```nasm
MOV AX,100
MOV DS,AX
```

| op1          | op2                           |
| ------------ | ----------------------------- |
| r8           | i8,r8,m8 пересылка байтов     |
| m8           | i8,r8                         |
| r16          | i16,r16,m16,sr пересылка слов |
| sr(кроме CS) | m16,r16                       |
| m16          | i16,r16,sr                    | 

Запрещено пересылать из одной ячейки памяти в другую, из одного сегментного регистра в другой, и непосредственно записывать операнд в сегментный регистр.

Размер пересылаемой величины определяется по типу операндов указанных в команде. Если известны размеры обоих операндов, то эти размеры должны совпадать, иначе ассемблер выдаст ошибку.

```nasm
X DB; TYPE X=BITE
Y DW ?; TYPE Y=WORD
MOV X,0; (X - байт)
MOV SI,0; (SI - регистр размером в слово)
MOV CH,X; пересылка байта
MOV DX,AL; (ошибка: DX - слово, AL - байт)
```

2. оператор указания типа `PTR`
   `<тип> PTR <выражение>`, где тип служебные слова - BYTE,WORD,DWORD
   Оператор PTR используется в двух случаях:
	   1. когда типы операндов не изменит явно указать тип одного из них. В регистре SI находится адрес некоторой ячейки памяти и требуется записать 0 в эту ячейку.
	   2. В регистре SI находится адрес некоторой ячейки памяти и требуется записать 0 в эту ячейку. Когда необходимо изменить тип указанной при описании переменной


```nasm 
MOV BYTE PTR [SI], 0    MOV [SI], BYTE PTR 0

MOV WORD PTR [SI], 0    MOV [SI] WORD PTR 0
```

```nasm
Z DW 1234h; Z:34h,z+1:12h

MOV BYTE PTR Z,0; Z:00h, Z+1:12h
```

3. команда перестановки двух операндов `XCHG`
   Флаги команда не меняет, операнды должны быть одного размера.
   `XCHG op1,op2`
   
   | op1 | op2                       |
   | --- | ------------------------- |
   | r8  | r8,m8 перестановка байтов |
   | m8  | r8                        |
   | r16 | r16,m16 перестановка слов |
   | m16 | r16                       | 

```nasm
MOV AX,62; AX=62
MOV SI,135; SI=135
XCHG AX,SI; AX=135,SI=62
```

## Арифметические команды

1. `ADD op1,op2`
    `SUB op1,op2`

| op1 | op2                                 |
| --- | ----------------------------------- |
| r8  | i8,r8,m8 сложение/вычитание байтов  |
| m8  | i8,r8                               |
| r16 | i16,r16,m16 сложение/вычитание слов |
| m16 | i16,r16                             | 

Меняются флаги переноса CF, переполнение OF, знака SF и нуля ZF

2. увеличение на 1: `INC op` и уменьшение на 1:`DEC op`
   Команды inc и dec не меняют флаг переноса CF и занимают меньше памяти.
   Допустимые операнды: `r8,m8,r16,m16`
3. изменение знака: `NEG op`
   Команда рассматривает свой операнд, как число со знаком и меняет его на противоположный.
   Допустимые операнды: `r8,m8,r16,m16`
   
   **Например:**
   
```nasm
MOV AH,1
NEG AH; AH=-1
```

4. сложение с учетом переноса: `ADC op1,op2`
   К сумме прибавляется `CF`. 
   Вычитание с учетом переноса: `SBB op1,op2`
   Вычитается значение `CF`
5. Умножение целых без знака: `MUL`
   Операнд может быть либо в регистре, либо в памяти, но не может быть непосредственным операндом. Местоположение фиксировано и явно в команде не участвует. При умножении в байтах первый множитель берется из регистра AL и не из какого другого. При умножении слов берется из регистра AX. Под результат умножения относится в 2 раза больше места, чем под сам множитель. При умножении байтов результат имеет слово и записывается в регистр AX (AH - записываются старшие разряды, AL - младшие разряды). при умножении слов результат имеет размер двойного слова и записывается в 2 регистра (DX - старшие разряды, AX - младшие разряды)
   
```nasm
N DB 10
MOV AL, 2
MUL N    ;AX=2*10=20=0014h  AH=OOh,AL=14h
MOV AL, 26
MUL N    ;AX=26*10=260=0104h  AH=01h, AL=04h
MOV AX, 8
MOV BX, -1
IMUL BX    ;(DX-AX)=-8=0FFFFFFF8h  DX=0FFFFh, AX=0FFF8h
```

Чтобы узнать вмещается ли результат в формат со множествами необходимо проанализировать флаги CF и OF. Если оба флага равны 1, то произведение занимает двойной формат. Если оба флага равны 0, то результат произведения байтов занимает регистр AL, а произведение слов AX

Операнд - это делитель, который может находится либо в регистре или ячейки памяти. 

При делении слова на байт, делимое находится в регистре AX. 

При делении двойного слова на слово, делимое находится в двух регистрах AX и DX.

В области целых чисел деление не возможно, и под делением понимают получение двух величин, это неполное частное (DIV) и остаток от деления (MOD). Оба эти числа помещаются на место делимого. 

Старшая часть делимого заменяется на остаток от деление, а младшее на не полное частное. Неполное частное и остаток имеют одинаковый размер, который совпадает с размером делителя.

При делении возможно появление ошибки с название "деление на 0" или "переполнение".

Пример на деление (ошибка):

```nasm
MOV AX, 600
MOV BH, 2
DIV BH    ;600 DIV 2 = 300, но 300 не вмещается в AL
```

## Изменение размера числа 

1. Расширение байта со знаком до слова: `CDW`
   
```nasm
MOV AL, 32    ;AL=20h
CBW    ;AX=0020h (число +32 как слово)
MOV AL, -32    ;AL=0E0H
CBW    ;AX=0FFE0h
```

2. Расширение слова со знаком до двойного слова: `CWD`
   
```nasm

```

## Битовые операции и упакованные данные

1. Логические команды
   Меняют все флаги условий, операнды либо байты, либо слова.
   
a. NOT op
   
```nasm
MOV AL, 1100b    ;AL=00001100b
NOT AL    ;AL=1111==11b
```

b. AND op1, op2

| op1 | op2         |
| --- | ----------- |
| r8  | i8,r8,m8    |
| m8  | i8,r8       |
| r16 | i16,r16,m16 |
| m16 | i16,        | 

c. OR op1, op2
d. XOR op1, op2 (исключающие ИЛИ)
Чаще всего используется для обнуления регистров.

2. Команда сдвига
   Имеют два операнда. Первый операнд рассматривается как набор битов, которые будут сдвигаться влево или вправо на несколько позиций. Второй операнд рассматривается как целое без знака и определяет на сколько позиций необходимо сдвинуть первый операнд. Второе операнд всегда находится в байтовом регистре CL и его значение не меняется командой сдвига. Команды сдвига меняют все флаги 