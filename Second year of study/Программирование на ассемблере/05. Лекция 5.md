## Изменение размера числа 

1. Расширение байта со знаком до слова: `CDW`
   
```nasm
MOV AL, 32    ;AL=20h
CBW    ;AX=0020h (число +32 как слово)
MOV AL, -32    ;AL=0E0H
CBW    ;AX=0FFE0h
```

2. Расширение слова со знаком до двойного слова: `CWD`

## Битовые операции и упакованные данные

1. Логические команды
   Меняют все флаги условий, операнды либо байты, либо слова.
   
a. `NOT op`
   
```nasm
MOV AL, 1100b    ;AL=00001100b
NOT AL    ;AL=1111==11b
```

b. `AND op1, op2`

| op1 | op2           |
| --- | ------------- |
| r8  | i8, r8, m8    |
| m8  | i8, r8        |
| r16 | i16, r16, m16 |
| m16 | i16, r16      | 

c. `OR op1, op2`
d. `XOR op1, op2` (исключающие ИЛИ)
Чаще всего используется для обнуления регистров.

2. Команда сдвига
   Имеют два операнда. Первый операнд рассматривается как набор битов, которые будут сдвигаться влево или вправо на несколько позиций. Второй операнд рассматривается как целое без знака и определяет на сколько позиций необходимо сдвинуть первый операнд. Второе операнд всегда находится в байтовом регистре CL и его значение не меняется командой сдвига. Команды сдвига меняют все флаги. Команды сдвига делятся на логический, арифметический, 
   
a. логический сдвиг: `SHL op, CL` и `SHR op, CL`
Бит, уходящий за пределы ячейки заносится в флаг CF, а с другого конца в операнд добавляются нули.
   
```nasm
MOV AL, 01000111b
SHR AL, 1    ;AL=00100011b, CF=1
MOV DH, 00111000b
MOV CL, 3
SHL DH, CL    ;CF=1, DH=11000000b
```

Основное применение команд логического сдвига - это быстрое умножение и деление целых чисел на степень двойки ($2^k$).

При сдвиге числа 5 на 3 разряда влево получаем: 
$5=101b$
$101000b=40=5\cdot 2^3$

В общем случаи умножение на $2^k$ реализуется:

```nasm
;op=op*2^k
MOV CL, k
SHL op, CL
```

Пример:

```nasm
;37*16
MOV CL, 4
MOV AX, 37
SHL AX, Cl
```

Правильно умножаются только знаковые числа от -64 до 63, или беззнаковые числа $\lt 128$, так как результат должен умещаться в ячейку.

При сдвиге на $k$ разрядов вправо, происходит отбрасывание последних $k-разрядов$, что соответствует получению не полного частного при делении на $2^k$. Такое деление возможно только для беззнаковых чисел.

Пример:
$18=10010b$ 
$10B=2=18 \; div \; 2^3$

```nasm
;op:=op div 2^k
MOV CL, K
SHR op, CL ;Только для беззнаковых чисел
```

b. арифметический сдвиг: `SAL op1, op2` и `SAR op1, op2`
После занятие уходящего бита в флаг CF, бит операнда восстанавливает свое значение

```nasm
MOV BH = 10001110b
SAR BH=1    ;BH=11000111b, CF=0
```

```nasm
MOV BH=0001110b
SAR BH=1    ;BH=00000111b, CF=0

```

c. цикличные сдвиги: `ROl op1, op2` (влево) и `ROR op1, op2` (вправо)
Уходящий бит не теряется, а возвращается в операнд с другого конца и одновременно записывается в флаг CF.

```nasm
MOV CH, 11000011b
ROL CH, 1    ;CF=1,CH=1000111b
```

Циклические сдвиги используются для перестановки частей содержимого ячейки или регистра.

d. циклические сдвиги через перенос: `RCL op, 1` и `RCR op, 1`
По команде RCL все биты левого операнда сдвигаются на одну позицию влево, самый правый попадает в CF, а прежнее значение флага заносится в самый правый разряд операнда.

```nasm
MOV BL, 11110000b    ;CF=0
RCL BL, 1    ;CF=1, BL=11100000b
RCL Bl, 1    ;CF=1, Bl=1100001b
```

Эти команды используются для/при переносе переменных/битов из одного регистра в другой.

```nasm
MOV CX, 3    ;сдвинуть на 3 влево
SHL DH, 1    ;значения регистров AL и DH
RCL AL, 1    ;справа к AL
LOOP L    ;3 левых бита регистра DH
```
